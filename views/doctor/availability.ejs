<% layout("/layouts/doctorBoilerplate") %>

    <!-- Main Section -->
    <main class="container my-5">

        <!-- Add Availability -->
        <section class="card shadow mb-4">
            <div class="card-body">
                <h2 class="h6 text-primary mb-3">Add New Availability Slot</h2>
                <form class="row g-3" method="post" action="/doctor/dashboard/availability">
                    <div class="col-md-4">
                        <label for="date" class="form-label">Date</label>
                        <input type="date" id="date" class="form-control" name="schedules[date]" />
                    </div>
                    <div class="col-md-4">
                        <label for="shift" class="form-label">Shift</label>
                        <input type="string" id="shift" class="form-control" name="schedules[shift]" />
                    </div>
                    <div class="col-md-4 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100">Add Slot</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Existing Availability -->
        <section class="card shadow">
            <div class="card-body">
                <h2 class="h6 text-primary mb-3">Your Available Slots</h2>
                <div class="table-responsive">
                    <table class="table table-bordered table-hover text-sm mb-0">
                        <thead class="table-primary">
                            <tr>
                                <th>Date</th>
                                <th>Day</th>
                                <th>Shift</th>
                                <th>Time</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for (let schedule of allSchedules) { %>
                                <% let dayName=new Date(schedule.date).toLocaleDateString('en-US', { weekday: 'long' });
                                    %>
                                    <% let formattedDate=new Date(schedule.date).toLocaleDateString('en-US', {
                                        year: 'numeric' , month: 'long' , day: 'numeric' }); %>
                                        <tr>
                                            <td>
                                                <%= formattedDate %>
                                            </td>
                                            <td><%= dayName %></td>
                                            <td><%= schedule.shift %></td>
                                            <% if(schedule.shift =="Morning") {%>
                                            <td>9:00 AM - 12:00 PM</td>
                                            <% } else {%>
                                                <td>3:00 PM - 8:00 PM </td>
                                            <% } %>
                                            <td>
                                                <form method="post" action="/doctor/dashboard/availability/<%= schedule._id %>?_method=DELETE">
                                                    <button class="btn btn-link btn-sm text-danger p-0">Delete</button>
                                                </form>
                                            </td>
                                        </tr>
                                        <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>